(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[374],{3374:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>S});var r=n(6658),o=n(9242);let u=(0,o.createContext)(null);function l(){let e=(0,o.use)(u);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var a=n(523),i=n.n(a);let c=(0,o.forwardRef)(function({bounds:e,boundsOptions:t,center:n,children:r,className:l,id:i,placeholder:c,style:s,whenReady:f,zoom:d,...p},m){let[y]=(0,o.useState)({className:l,id:i,style:s}),[g,v]=(0,o.useState)(null),h=(0,o.useRef)(void 0);(0,o.useImperativeHandle)(m,()=>g?.map??null,[g]);let b=(0,o.useCallback)(r=>{if(null!==r&&!h.current){let o=new a.Map(r,p);h.current=o,null!=n&&null!=d?o.setView(n,d):null!=e&&o.fitBounds(e,t),null!=f&&o.whenReady(f),v(Object.freeze({__version:1,map:o}))}},[]);(0,o.useEffect)(()=>()=>{g?.map.remove()},[g]);let C=g?o.createElement(u,{value:g},r):c??null;return o.createElement("div",{...y,ref:b},C)});var s=n(8772);function f(e,t){let n=(0,o.useRef)(t);(0,o.useEffect)(function(){t!==n.current&&null!=e.attributionControl&&(null!=n.current&&e.attributionControl.removeAttribution(n.current),null!=t&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}function d(e,t){let n=(0,o.useRef)(void 0);(0,o.useEffect)(function(){return null!=t&&e.instance.on(t),n.current=t,function(){null!=n.current&&e.instance.off(n.current),n.current=null}},[e,t])}function p(e,t){let n=e.pane??t.pane;return n?{...e,pane:n}:e}function m(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function y(e,t){return null==t?function(t,n){let r=(0,o.useRef)(void 0);return r.current||(r.current=e(t,n)),r}:function(n,r){let u=(0,o.useRef)(void 0);u.current||(u.current=e(n,r));let l=(0,o.useRef)(n),{instance:a}=u.current;return(0,o.useEffect)(function(){l.current!==n&&(t(a,n,l.current),l.current=n)},[a,n,t]),u}}function g(e){return function(t){var n;let r=l(),u=e(p(t,r),r);return f(r.map,t.attribution),d(u.current,t.eventHandlers),n=u.current,(0,o.useEffect)(function(){return(r.layerContainer??r.map).addLayer(n.instance),function(){r.layerContainer?.removeLayer(n.instance),r.map.removeLayer(n.instance)}},[r,n]),u}}let v=function(e,t){var n;return n=g(y(e,t)),(0,o.forwardRef)(function(e,t){let{instance:r}=n(e).current;return(0,o.useImperativeHandle)(t,()=>r),null})}(function({url:e,...t},n){return m(new a.TileLayer(e,p(t,n)),n)},function(e,t,n){let{opacity:r,zIndex:o}=t;null!=r&&r!==n.opacity&&e.setOpacity(r),null!=o&&o!==n.zIndex&&e.setZIndex(o);let{url:u}=t;null!=u&&u!==n.url&&e.setUrl(u)});n(5286),n(5194);let h=function(e,t){var n;return n=g(y(e,t)),(0,o.forwardRef)(function(e,t){let{instance:r,context:l}=n(e).current;(0,o.useImperativeHandle)(t,()=>r);let{children:a}=e;return null==a?null:o.createElement(u,{value:l},a)})}(function({position:e,...t},n){var r;let o=new a.Marker(e,t);return m(o,(r={overlayContainer:o},Object.freeze({...n,...r})))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}),b=function(e,t){var n,r;return n=y(e),r=function(e,r){let o=l(),u=n(p(e,o),o);return f(o.map,e.attribution),d(u.current,e.eventHandlers),t(u.current,o,e,r),u},(0,o.forwardRef)(function(e,t){let[n,u]=(0,o.useState)(!1),{instance:l}=r(e,u).current;(0,o.useImperativeHandle)(t,()=>l),(0,o.useEffect)(function(){n&&l.update()},[l,n,e.children]);let a=l._contentNode;return a?(0,s.createPortal)(e.children,a):null})}(function(e,t){return m(new a.Popup(e,t.overlayContainer),t)},function(e,t,{position:n},r){(0,o.useEffect)(function(){let{instance:o}=e;function u(e){e.popup===o&&(o.update(),r(!0))}function l(e){e.popup===o&&r(!1)}return t.map.on({popupopen:u,popupclose:l}),null==t.overlayContainer?(null!=n&&o.setLatLng(n),o.openOn(t.map)):t.overlayContainer.bindPopup(o),function(){t.map.off({popupopen:u,popupclose:l}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(o)}},[e,t,r,n])});function C(){return l().map}function k(e){let{project:t}=e,n=l().map;return(0,r.jsx)(h,{position:[t.Latitude,t.Longitude],icon:function(){let{className:e="custom-marker",iconSize:t=[24,24],iconAnchor:n=[12,24],html:r=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i().divIcon({className:e,iconSize:t,iconAnchor:n,html:r})}(),eventHandlers:{click:()=>{n.flyTo([t.Latitude,t.Longitude],12,{duration:1.5,easeLinearity:.15})}},children:(0,r.jsxs)(b,{children:[(0,r.jsx)("strong",{children:t.ProjectCategory}),"A pretty CSS3 popup. ",(0,r.jsx)("br",{})," Easily customizable."]})})}function w(){let e=l().map,t=(0,o.useRef)(null),n=(0,o.useRef)(!1),r=(0,o.useRef)(!1),u=(0,o.useRef)(null);return(0,o.useEffect)(()=>{if(e){if(!i().TileLayer.Mask){console.log("CSSMaskedTileLayer: Mask plugin not loaded yet, waiting...");let e=()=>{i().TileLayer.Mask?(console.log("CSSMaskedTileLayer: Mask plugin now available"),o()):setTimeout(e,100)};e();return}o()}function o(){try{let o=new(i()).TileLayer.Mask("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maskUrl:(()=>{let e=document.createElement("canvas");e.width=512,e.height=512;let t=e.getContext("2d");if(!t)return null;t.fillStyle="black",t.fillRect(0,0,512,512);let n=512/3,r=t.createRadialGradient(256,256,0,256,256,n);return r.addColorStop(0,"rgba(255, 255, 255, 1.0)"),r.addColorStop(.3,"rgba(255, 255, 255, 0.95)"),r.addColorStop(.5,"rgba(255, 255, 255, 0.8)"),r.addColorStop(.7,"rgba(255, 255, 255, 0.5)"),r.addColorStop(.85,"rgba(255, 255, 255, 0.2)"),r.addColorStop(1,"rgba(255, 255, 255, 0.0)"),t.fillStyle=r,t.beginPath(),t.arc(256,256,n,0,2*Math.PI),t.fill(),e.toDataURL()})(),maskSize:512,attribution:"&copy; Esri"});o.addTo(e),t.current=o;let l=i().point(-1e3,-1e3);o.setCenter(l);let a=()=>{if(t.current){let e=i().point(-1e3,-1e3);t.current.setCenter(e)}},c=()=>{t.current&&u.current&&!n.current&&t.current.setCenter(u.current)},s=e=>{u.current=e.containerPoint,t.current&&!n.current&&t.current.setCenter(e.containerPoint)},f=()=>{if(!n.current&&t.current){let n=e.getSize().divideBy(2);u.current=n,t.current.setCenter(n)}},d=()=>{a(),u.current=null},p=e.flyTo.bind(e);e.flyTo=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return console.log("FlyTo started - hiding mask"),r.current=!0,n.current=!0,a(),p(...t)};let m=()=>{r.current&&(console.log("FlyTo ended - ready to show mask again"),setTimeout(()=>{r.current=!1,n.current=!1,u.current&&c()},200))};return e.on("mousemove",s),e.on("mouseenter",f),e.on("mouseleave",d),e.on("moveend",m),()=>{e.flyTo=p,e.off("mousemove",s),e.off("mouseenter",f),e.off("mouseleave",d),e.off("moveend",m),t.current&&e.removeLayer(t.current)}}catch(e){console.error("CSSMaskedTileLayer: Error creating mask layer:",e)}}},[e]),null}function S(){let{projects:e,error:t}=function(){let[e,t]=(0,o.useState)([]),[n,r]=(0,o.useState)(""),[u,l]=(0,o.useState)([]),[a,i]=(0,o.useState)(null);(0,o.useEffect)(()=>{(async()=>{try{let e=await fetch("https://raw.githubusercontent.com/AdamFehse/map-app/gh-pages/storymapdata_db_ready_v2.json");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let n=await e.json();t(n);let r=[...new Set(n.map(e=>e.ProjectCategory).filter(Boolean))];l(r)}catch(e){e&&"object"==typeof e&&"message"in e?i(e.message):i("Unknown error")}})()},[]);let c=(0,o.useMemo)(()=>n?e.filter(e=>e.ProjectCategory===n):e,[e,n]),s=(0,o.useCallback)(e=>{r(e)},[]),f=(0,o.useCallback)(()=>e.filter(e=>e.Artworks&&e.Artworks.length>0),[e]),d=(0,o.useCallback)(()=>e.filter(e=>e.Poems&&e.Poems.length>0),[e]),p=(0,o.useCallback)(()=>{let t=new Set;return e.forEach(e=>{e.Activities&&e.Activities.forEach(e=>{t.add(e)})}),Array.from(t)},[e]);return{projects:e,filteredProjects:c,categories:u,error:a,filterProjects:s,getProjectsWithArtworks:f,getProjectsWithPoems:d,getUniqueActivities:p}}();return((0,o.useEffect)(()=>{let e=document.createElement("script");e.src="/leaflet-tilelayer-mask.js",e.async=!0,document.body.appendChild(e)},[]),t)?(0,r.jsxs)("div",{children:["Error: ",t]}):e.length?(0,r.jsxs)(c,{center:[31.313354,-110.945987],zoom:7,style:{height:"100vh",width:"100%"},children:[(0,r.jsx)(v,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,r.jsx)(w,{}),e.map((e,t)=>(0,r.jsx)(k,{project:e},t))]}):(0,r.jsx)("div",{children:"Loading..."})}},5194:()=>{},5286:()=>{}}]);
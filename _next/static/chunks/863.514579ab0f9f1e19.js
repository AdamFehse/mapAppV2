(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{1863:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var r=n(6658),i=n(9242),o=n(6956),s=n(4361),a=n(3832);n(5286),n(2916),n(7373),n(5194);var l=n(1946),c=n(523),u=n.n(c);n(8182);let m=e=>{let{map:t,projects:n}=e,r=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(!t||!n||0===n.length)return;r.current&&(t.removeLayer(r.current),r.current=null);let e=u().markerClusterGroup({iconCreateFunction:function(e){let t=e.getChildCount(),n="#1976d2",r=40;return t>=100?(n="#d32f2f",r=60):t>=10&&(n="#388e3c",r=50),u().divIcon({html:'\n            <svg width="'.concat(r,'" height="').concat(r,'" viewBox="0 0 ').concat(r," ").concat(r,'">\n              <circle cx="').concat(r/2,'" cy="').concat(r/2,'" r="').concat(r/2-3,'" fill="').concat(n,'" stroke="#fff" stroke-width="3"/>\n              <text x="50%" y="55%" text-anchor="middle" font-size="').concat(r/2.5,'" fill="#fff" font-weight="bold" dominant-baseline="middle">').concat(t,"</text>\n            </svg>\n          "),className:"custom-cluster-icon",iconSize:[r,r]})}});return n.forEach(t=>{if(t.Latitude&&t.Longitude){let n=u().marker([t.Latitude,t.Longitude],{icon:function(){let{className:e="custom-marker",iconSize:t=[24,24],iconAnchor:n=[12,24],html:r=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u().divIcon({className:e,iconSize:t,iconAnchor:n,html:r})}()});n.bindPopup("\n          <strong>".concat(t.ProjectCategory,"</strong>\n          <br />\n          A pretty CSS3 popup. <br /> Easily customizable.\n        ")),e.addLayer(n)}}),e.addTo(t),r.current=e,()=>{r.current&&(t.removeLayer(r.current),r.current=null)}},[t,n]),null};function h(){let e=(0,o.ko)(),{projects:t}=(0,l.Y)();return(0,r.jsx)(m,{map:e,projects:t})}function d(e){let{children:t,showMarkers:n=!0}=e,{projects:o,error:c}=(0,l.Y)();return((0,i.useEffect)(()=>{let e=document.createElement("script");e.textContent='\n      (function() {\n        L.TileLayer.Mask = L.TileLayer.extend({\n          options: {\n            maskSize: 512\n          },\n          getMaskSize: function() {\n            var s = this.options.maskSize;\n            return s instanceof L.Point ? s : new L.Point(s, s);\n          },\n          setCenter: function(containerPoint) {\n            if (arguments.length === 2) {\n              this.setCenter(L.point(arguments[0], arguments[1]));\n              return;\n            }\n            if (this._map) {\n              var p = this._map.containerPointToLayerPoint(containerPoint);\n              p = p.subtract(this.getMaskSize().divideBy(2));\n              this._image.setAttribute("x", p.x);\n              this._image.setAttribute("y", p.y);\n            }\n          },\n          _initContainer: function() {\n            if (this._container) return;\n            var rootGroup = this._map.getRenderer(this)._rootGroup;\n            var defs = rootGroup.appendChild(L.SVG.create("defs"));\n            var container = rootGroup.appendChild(L.SVG.create("g"));\n            var mask = defs.appendChild(L.SVG.create("mask"));\n            var image = mask.appendChild(L.SVG.create("image"));\n            var size = this.getMaskSize();\n            mask.setAttribute("id", "leaflet-tilelayer-mask-" + L.stamp(this));\n            mask.setAttribute("x", "-100%");\n            mask.setAttribute("y", "-100%");\n            mask.setAttribute("width", "300%");\n            mask.setAttribute("height", "300%");\n            image.setAttribute("width", size.x);\n            image.setAttribute("height", size.y);\n            image.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", this.options.maskUrl);\n            container.setAttribute("mask", "url(#" + mask.getAttribute("id") + ")");\n            this._container = container;\n            this._image = image;\n            this.setCenter(this._map.getSize().divideBy(2));\n          },\n          _updateLevels: function() {\n            var zoom = this._tileZoom;\n            if (zoom === undefined)\n              return undefined;\n\n            for (var z in this._levels) {\n              if (!this._levels[z].el.firstChild && z !== zoom) {\n                L.DomUtil.remove(this._levels[z].el);\n                this._removeTilesAtZoom(z);\n                delete this._levels[z];\n              }\n            }\n\n            var level = this._levels[zoom];\n            if (!level) {\n              var map = this._map;\n              level = {\n                el: this._container.appendChild(L.SVG.create("g")),\n                origin: map.project(map.unproject(map.getPixelOrigin()), zoom).round(),\n                zoom: zoom\n              };\n              this._setZoomTransform(level, map.getCenter(), map.getZoom());\n              L.Util.falseFn(level.el.offsetWidth);\n              this._levels[zoom] = level;\n            }\n            this._level = level;\n            return level;\n          },\n          _addTile: function(coords, container) {\n            var tilePos = this._getTilePos(coords);\n            var tileSize = this.getTileSize();\n            var key = this._tileCoordsToKey(coords);\n            var url = this.getTileUrl(this._wrapCoords(coords));\n\n            var tile = container.appendChild(L.SVG.create("image"));\n            tile.setAttribute("width", tileSize.x);\n            tile.setAttribute("height", tileSize.y);\n            tile.setAttribute("x", tilePos.x);\n            tile.setAttribute("y", tilePos.y);\n            tile.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", url);\n\n            this._tiles[key] = {\n              el: tile,\n              coords: coords,\n              current: true\n            };\n          },\n          _setZoomTransform: function(level, center, zoom) {\n            var scale = this._map.getZoomScale(zoom, level.zoom),\n              translate = level.origin.multiplyBy(scale)\n              .subtract(this._map._getNewPixelOrigin(center, zoom)).round();\n            level.el.setAttribute("transform", "translate(" + translate.x + "," + translate.y + ")");\n          }\n        });\n\n        L.tileLayer.mask = function(url, options) {\n          return new L.TileLayer.Mask(url, options);\n        };\n\n      })();\n    ',document.body.appendChild(e)},[]),c)?(0,r.jsxs)("div",{children:["Error: ",c]}):o.length?(0,r.jsxs)(s.W,{center:[31.313354,-110.945987],zoom:7,style:{height:"100vh",width:"100%",position:"relative"},children:[(0,r.jsx)(a.e,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',minZoom:0,maxZoom:16}),n&&(0,r.jsx)(h,{}),t]}):(0,r.jsx)("div",{children:"Loading..."})}},1946:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});var r=n(9242);function i(){let[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(""),[o,s]=(0,r.useState)([]),[a,l]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("https://raw.githubusercontent.com/AdamFehse/map-app/gh-pages/storymapdata_db_ready_v2.json");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let n=await e.json();t(n);let r=[...new Set(n.map(e=>e.ProjectCategory).filter(Boolean))];s(r)}catch(e){e&&"object"==typeof e&&"message"in e?l(e.message):l("Unknown error")}})()},[]);let c=(0,r.useMemo)(()=>n?e.filter(e=>e.ProjectCategory===n):e,[e,n]),u=(0,r.useCallback)(e=>{i(e)},[]),m=(0,r.useCallback)(()=>e.filter(e=>e.Artworks&&e.Artworks.length>0),[e]),h=(0,r.useCallback)(()=>e.filter(e=>e.Poems&&e.Poems.length>0),[e]),d=(0,r.useCallback)(()=>{let t=new Set;return e.forEach(e=>{e.Activities&&e.Activities.forEach(e=>{t.add(e)})}),Array.from(t)},[e]);return{projects:e,filteredProjects:c,categories:o,error:a,filterProjects:u,getProjectsWithArtworks:m,getProjectsWithPoems:h,getUniqueActivities:d}}},5194:()=>{}}]);